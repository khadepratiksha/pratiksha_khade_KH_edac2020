cursor assignment;|
+++++++++++++++++++


1.

delimiter $$
create procedure Q4A1()
begin
declare salary numeric;
declare ename1 varchar(50);
declare finished int default 0;
declare  c_serach cursor for select ename,sal from empnew where JOB='ANALYST';
declare continue handler for not found set finished=1;
open c_serach;
get_sal : loop
fetch  c_serach into ename1,salary;
if finished =1
then
leave get_sal;
end if;
select ename1,salary from empnew; 
end loop;
close  c_serach;
end$$

drop procedure Q4A1;
==================================================================================================================================================================
2.
  
DELIMITER $$
CREATE PROCEDURE cur_e()
BEGIN
DECLARE sal_point int;
DECLARE c_emp int;
DECLARE e_nam varchar(20);
DECLARE finished int default 0;
DECLARE sa_cur CURSOR FOR SELECT EMPNO,ENAME,SAL FROM EMPNEW ORDER BY sal DESC LIMIT  5;
DECLARE CONTINUE HANDLER FOR NOT FOUND SET finished = 1;
OPEN sa_cur;
get_sal : LOOP
          FETCH sa_cur INTO c_emp,e_nam,sal_point;
       IF finished = 1
       THEN
       LEAVE get_sal;
       END IF;
        SELECT c_emp,e_nam,sal_point FROM EMPNEW;
       END LOOP get_sal;
       	CLOSE sa_cur;
        END $$
        
        CALL cur_e();

=======================================================================================================================================================================
3.
DELIMITER $$
CREATE PROCEDURE cur_ee()
BEGIN

DECLARE e_nam varchar(20);
DECLARE finished int default 0;
DECLARE sa_cur CURSOR FOR SELECT concat(ENAME,JOB) FROM EMPNEW;
DECLARE CONTINUE HANDLER FOR NOT FOUND SET finished = 1;
OPEN sa_cur;
get_sal : LOOP
          FETCH sa_cur INTO e_nam;
       IF finished = 1
       THEN
       LEAVE get_sal;
       END IF;
        SELECT e_nam FROM EMPNEW WHERE ENAME='Pooja';
       END LOOP get_sal;
       	CLOSE sa_cur;
        END $$ 
        
        CALL cur_ee()
==========================================================================================================================================================================
4.
DELIMITER $$
CREATE PROCEDURE cur_eee()
BEGIN
DECLARE e_no int;
DECLARE e_nam varchar(20);
DECLARE e_job varchar(20);
DECLARE e_mg int;
DECLARE e_date DATE;
DECLARE e_sal int;
DECLARE e_d int;
DECLARE finished int default 0;
DECLARE sa_cur CURSOR FOR SELECT *FROM EMPNEW WHERE ENAME='Manish';
DECLARE CONTINUE HANDLER FOR NOT FOUND SET finished = 1;
OPEN sa_cur;
get_sal : LOOP
          FETCH sa_cur INTO e_no,e_nam,e_job,e_mg,e_date,e_sal,e_d;
       IF finished = 1
       THEN
       LEAVE get_sal;
       END IF;
        SELECT e_no,e_nam,e_job,e_mg,e_date,e_sal,e_d FROM EMPNEW;
       END LOOP get_sal;
       	CLOSE sa_cur;
        END $$ 
 DROP PROCEDURE cur_eee;
        
        CALL cur_eee();
========================================================================================================================================================================
5.
 DELIMITER $$
CREATE PROCEDURE DELEMPNO_DATA()
BEGIN
DECLARE LLEMPNO numeric(4) DEFAULT 0;
DECLARE ERR INT  DEFAULT 0;

DECLARE DELEMPNO CURSOR FOR SELECT EMPNO FROM EMPNEW WHERE SAL<10000;
DECLARE CONTINUE HANDLER FOR NOT FOUND SET ERR=1;

OPEN DELEMPNO;
     TEST:LOOP
        FETCH DELEMPNO  INTO LLEMPNO;
        IF ERR=1 THEN 
           LEAVE TEST;
		END IF;
       DELETE FROM EMPNEW WHERE EMPNO=LLEMPNO;
    END LOOP TEST;
CLOSE DELEMPNO;
END $$
CALL DELEMPNO_DATA();  
========================================================================================================================================================================
